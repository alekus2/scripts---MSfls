def execute(self, parameters, messages):
    fc = parameters[0].valueAsText
    campo_index = "Index"
    campo_contador = "CONTADOR"
    campo_manter = "MANTER"

    # 1) Calcula contagens por Index
    contagens = defaultdict(int)
    with arcpy.da.SearchCursor(fc, [campo_index]) as s_cursor:
        for row in s_cursor:
            contagens[row[0]] += 1

    # 2) Imprime cada contagem no painel de mensagens
    arcpy.AddMessage("=== Contagem de parcelas por Index ===")
    for idx, cnt in sorted(contagens.items()):
        arcpy.AddMessage(f"Index {idx}: {cnt} parcela(s)")

    # 3) Determina o máximo geral (opcional, mas você já calculava)
    maximo_geral = max(contagens.values())

    # 4) Atualiza os campos CONTADOR e MANTER
    with arcpy.da.UpdateCursor(fc, [campo_index, campo_contador, campo_manter]) as u_cursor:
        for row in u_cursor:
            idx = row[0]
            cnt = contagens[idx]
            row[1] = cnt
            row[2] = self.autoIncrement(cnt, maximo_geral)
            u_cursor.updateRow(row)

    arcpy.AddMessage("Processamento concluído com sucesso.")
